(this["webpackJsonpreact-brainfucked"]=this["webpackJsonpreact-brainfucked"]||[]).push([[0],{382:function(e,t,r){},383:function(e,t,r){},384:function(e,t,r){"use strict";r.r(t);var n=r(1),a=r.n(n),i=r(60),c=r.n(i),o=r(6),u=r(17),s=function(e){return Object(u.a)(Object(u.a)({},e),{},{buffer:e.buffer.slice(0),readBuffer:e.readBuffer.slice(0)})},d=function(e){return{buffer:[],size:e,pointer:0,readPointer:0,readBuffer:[],pendingSize:0}},l=function(e,t){switch(t.type){case"read":return function(e,t){var r=s(e);return r.pendingSize>0||r.buffer.length<=r.readPointer?(r.pendingSize+=t,r):(r.readBuffer=r.buffer.slice(r.readPointer,r.readPointer+t),r.readPointer=r.readPointer+r.readBuffer.length,r.readBuffer.length<t&&(r.pendingSize+=t-r.readBuffer.length),r)}(e,t.data);case"write":return function(e,t){"number"==typeof t&&(t=[t]);var r=s(e);return r.buffer=r.buffer.slice(0,r.pointer).concat(t),r.pointer+=t.length,r.pendingSize>0&&(r.pendingSize=Math.max(r.pendingSize-t.length,0)),r}(e,t.data);case"seek":return function(e,t){var r=s(e);return r.pointer=t,r.readPointer=t,r}(e,t.data)}},f=r(61),p=new Set(["<",">",",",".","[","]","+","-"]),b=function(e){return Object(u.a)({},e)},j=function(e){return e.memory.query(e.dataPointer)},h=function(e,t){return e.memory=e.memory.update(e.dataPointer,t)},m=function(e){return e.programCounter===e.program.length},g=function(e){return e.programCounter>0||e.blocked},O=function(e){var t=[];if(e.startsWith("[")){for(var r=1,n=1;r>0;){if("["===e[n]&&r++,"]"===e[n]&&r--,n>3e4)throw new Error("Unbalanced brackets");n++}e=e.slice(n+1)}var a,i=Object(f.a)(e);try{for(i.s();!(a=i.n()).done;){var c=a.value;p.has(c)&&t.push(c)}}catch(o){i.e(o)}finally{i.f()}return t},v=function(e,t){switch(t.type){case"next":return function(e){if(m(e))return e;var t=b(e),r=function(e){return e.program[e.programCounter]}(t),n=!1;if(t.skipping&&"]"!==r)return t.programCounter++,t;switch(r){case">":t.dataPointer++;break;case"<":t.dataPointer--;break;case"+":h(t,j(t)+1);break;case"-":h(t,j(t)-1);break;case",":if(t.blocked)return t;if(t.stdin=l(t.stdin,{type:"read",data:1}),t.stdin.pendingSize>0)return t.blocked=!0,t;if(h(t,t.stdin.readBuffer[0]),void 0===t.stdin.readBuffer[0])throw new Error("invalid write ".concat(t.stdin));break;case".":t.stdout=l(t.stdout,{type:"write",data:j(t)});break;case"[":0!==j(t)?t.jmpStack.push(t.programCounter):t.skipping=!0;break;case"]":0===j(t)?t.jmpStack.pop():(t.programCounter=t.jmpStack[t.jmpStack.length-1]+1,n=!0)}return n||t.programCounter++,t}(e);case"write":return function(e,t){var r=b(e);return r.stdin=l(r.stdin,{type:"write",data:t}),0===r.stdin.pendingSize&&(r.blocked=!1),r}(e,t.data)}},x=r(3),k=r(14),y=function e(t,r,n){var a,i;if(r>n)throw new Error("Cannot parse an empty array");var c=r+Math.floor((n-r)/2),o=r<c?e(t,r,c-1):void 0,u=n>c?e(t,c+1,n):void 0;return{size:(null!==(a=null===o||void 0===o?void 0:o.size)&&void 0!==a?a:0)+(null!==(i=null===u||void 0===u?void 0:u.size)&&void 0!==i?i:0)+1,key:c,value:t[c],left:o,right:u}},S=function e(t,r){if(!r)throw new Error("List index out of bounds");return r.key===t?r.value:r.key>t?e(t,r.left):e(t,r.right)},w=function e(t,r,n){if(!n)throw new Error("List index out of bounds");var a=Object.assign({},n);return a.key===t?(a.value=r,a):(a.key>t?a.left=e(t,r,a.left):a.right=e(t,r,a.right),a)},C=function e(t,r,n,a){if(!a)throw new Error("List index out of range");a.left&&e(t,r,n,a.left),a.key>=r&&a.key<n&&t.push(a.value),a.right&&e(t,r,n,a.right)},z=function(){function e(t){Object(x.a)(this,e),this.root=void 0,t.fromArray?this.root=y(t.array,0,t.array.length-1):this.root=t.root}return Object(k.a)(e,[{key:"query",value:function(e){return S(e,this.root)}},{key:"update",value:function(t,r){return new e({fromArray:!1,root:w(t,r,this.root)})}},{key:"slice",value:function(e,t){var r=[];return C(r,e,t,this.root),r}},{key:"size",value:function(){return this.root.size}}]),e}(),N=function(e){return new z({fromArray:!0,array:e})},P=2<<16,B=function(e){for(var t=0;!m(e)&&++t<P;)e=v(e,{type:"next"});return t!==P||m(e)||console.error("Time limit exceed"),{finalState:e,numCycles:t,ended:m(e)}},E=r(7),A=function(e){return String.fromCharCode.apply(String,Object(E.a)(e))},M=function(e){return Array.from(e).map((function(e){return e.charCodeAt(0)}))},q=function(e){return t=e,r=d(2048),n=d(2048),{programCounter:0,dataPointer:0,memory:N(Array(3e4).fill(0)),jmpStack:[],program:t,skipping:!1,blocked:!1,stdin:r,stdout:n};var t,r,n},F=(r(73),r(74),r(0)),L=function(e){var t=e.programState,r=e.dispatch,a=Object(n.useState)(""),i=Object(o.a)(a,2),c=i[0],u=i[1],s=Object(n.useMemo)((function(){return{output:A(t.stdout.buffer),input:A(t.stdin.buffer)}}),[t]);return Object(F.jsxs)("div",{children:[Object(F.jsx)("p",{children:"Output"}),Object(F.jsx)("div",{className:"console",children:Object(F.jsx)("div",{className:"console-text",children:Object(F.jsx)("pre",{children:s.output})})}),Object(F.jsx)("p",{children:"Input"}),Object(F.jsxs)("div",{className:"console with-input",children:[Object(F.jsx)("div",{className:"console-text",children:Object(F.jsx)("pre",{children:s.input})}),Object(F.jsx)("div",{className:"console-input",children:Object(F.jsx)("input",{placeholder:"This is the console",value:c,onKeyUp:function(e){"Enter"===e.key&&(r({type:"write",data:c}),u(""))},onChange:function(e){return u(e.target.value+"\n")}})})]})]})},R=(r(76),function(e){var t=e.programState,r=e.dispatch;return Object(F.jsxs)(F.Fragment,{children:[Object(F.jsxs)("p",{children:["Control Panel"," ",0===t.program.length&&Object(F.jsx)("span",{className:"note",children:"(enter any bf program to get started)"})]}),Object(F.jsxs)("ul",{className:"panel",children:[Object(F.jsx)("li",{children:Object(F.jsx)("button",{className:"btn",onClick:function(){return r({type:"run"})},disabled:0===t.program.length,children:"Run"})}),Object(F.jsx)("li",{children:Object(F.jsx)("button",{className:"btn",onClick:function(){return r({type:"next"})},disabled:m(t)||t.blocked,children:g(t)?"Step".concat(t.blocked?" (input required)":""):"Start"})}),Object(F.jsx)("li",{children:Object(F.jsx)("button",{className:"btn",onClick:function(){return r({type:"reset"})},disabled:0===t.program.length,children:"Reset"})})]})]})}),I=r(67),J=function(e){var t=e.code,r=e.setCode,n=e.enabled;return Object(F.jsxs)(F.Fragment,{children:[Object(F.jsx)("p",{children:"Editor"}),Object(F.jsx)(I.a,{value:t,language:"brainfuck",placeholder:"brainfuck program here",onChange:function(e){return r(e.target.value)},padding:10,style:{border:"1px solid black",borderRadius:"var(--border-radius)"},disabled:!n})]})},T=(r(382),function(e){var t=e.programState;return Object(F.jsxs)(F.Fragment,{children:[Object(F.jsx)("p",{children:"Visualization"}),Object(F.jsxs)("div",{className:"visualization",children:[Object(F.jsxs)("div",{className:"program-field",children:[t.program.map((function(e,r){return Object(F.jsx)("span",{className:g(t)&&(n=r,!t.blocked&&(n===t.programCounter-1||0===n&&0===t.programCounter)||t.blocked&&n===t.programCounter)?"highlighted":"",children:e},r);var n})),Object(F.jsx)("p",{children:"parsed program"})]}),Object(F.jsxs)("div",{children:[Object(F.jsxs)("p",{children:["program counter: ",t.programCounter,t.blocked?" (waiting for input)":""]}),Object(F.jsxs)("p",{children:["data pointer: ",t.dataPointer]}),Object(F.jsxs)("p",{children:["current data: ",t.memory.query(t.dataPointer)]})]})]})]})});var U=function(){var e=Object(n.useState)(""),t=Object(o.a)(e,2),r=t[0],a=t[1],i=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=Object(n.useState)(e),r=Object(o.a)(t,2),a=r[0],i=r[1],c=Object(n.useMemo)((function(){return O(a)}),[a]),u=Object(n.useState)(q(c)),s=Object(o.a)(u,2),d=s[0],l=s[1],f=Object(n.useCallback)((function(e){switch(e.type){case"load":i(e.data);break;case"next":l((function(e){return v(e,{type:"next"})}));break;case"run":l((function(e){return B(e).finalState}));break;case"reset":l(q(c));break;case"write":l((function(t){return v(t,{type:"write",data:M(e.data)})}))}}),[i,l,c]);return[d,f]}(r),c=Object(o.a)(i,2),u=c[0],s=c[1],d=Object(n.useState)(!0),l=Object(o.a)(d,1)[0];return Object(n.useEffect)((function(){s({type:"load",data:r}),s({type:"reset"})}),[r,s]),Object(F.jsx)("div",{className:"App",children:Object(F.jsxs)("main",{className:"App-main",children:[Object(F.jsx)("div",{children:Object(F.jsx)("h1",{id:"center",children:"react-brainfucked"})}),Object(F.jsxs)("div",{children:[Object(F.jsx)(J,{code:r,setCode:a,enabled:l}),Object(F.jsx)(T,{programState:u}),Object(F.jsx)(R,{programState:u,dispatch:s}),Object(F.jsx)(L,{programState:u,dispatch:s})]})]})})};r(383);c.a.render(Object(F.jsx)(a.a.StrictMode,{children:Object(F.jsx)(U,{})}),document.getElementById("root"))},73:function(e,t,r){},74:function(e,t,r){},76:function(e,t,r){}},[[384,1,2]]]);
//# sourceMappingURL=main.e901f9c6.chunk.js.map