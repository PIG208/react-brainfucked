(this["webpackJsonpreact-brainfucked"]=this["webpackJsonpreact-brainfucked"]||[]).push([[0],{382:function(e,t,r){},383:function(e,t,r){},384:function(e,t,r){"use strict";r.r(t);var n=r(1),a=r.n(n),i=r(60),o=r.n(i),c=r(6),u=r(17),s=function(e){return Object(u.a)(Object(u.a)({},e),{},{buffer:e.buffer.slice(0),readBuffer:e.readBuffer.slice(0)})},d=function(e){return{buffer:[],size:e,pointer:0,readPointer:0,readBuffer:[]}},f=function(e,t){switch(t.type){case"read":return function(e,t){var r=s(e);if(r.buffer.length<=r.readPointer)throw new Error("buffer overflowed");return r.readBuffer=r.buffer.slice(r.readPointer,r.readPointer+t),r.readPointer=r.readPointer+t,r}(e,t.data);case"write":return function(e,t){"number"==typeof t&&(t=[t]);var r=s(e);return r.buffer=r.buffer.slice(0,r.pointer).concat(t),r.pointer+=t.length,r}(e,t.data);case"seek":return function(e,t){var r=s(e);return r.pointer=t,r.readPointer=t,r}(e,t.data)}},l=r(61),b=new Set(["<",">",",",".","[","]","+","-"]),p=function(e){return Object(u.a)({},e)},j=function(e){return e.memory.query(e.dataPointer)},h=function(e,t){return e.memory=e.memory.update(e.dataPointer,t)},m=function(e){return e.programCounter===e.program.length},v=function(e){return e.programCounter>0},g=function(e){var t=[];if(e.startsWith("[")){for(var r=1,n=1;r>0;){if("["===e[n]&&r++,"]"===e[n]&&r--,n>3e4)throw new Error("Unbalanced brackets");n++}e=e.slice(n+1)}var a,i=Object(l.a)(e);try{for(i.s();!(a=i.n()).done;){var o=a.value;b.has(o)&&t.push(o)}}catch(c){i.e(c)}finally{i.f()}return t},O=function(e,t){switch(t.type){case"next":return function(e){if(m(e))return e;var t=p(e),r=function(e){return e.program[e.programCounter]}(t),n=!1;if(t.skipping&&"]"!==r)return t.programCounter++,t;switch(r){case">":t.dataPointer++;break;case"<":t.dataPointer--;break;case"+":h(t,j(t)+1);break;case"-":h(t,j(t)-1);break;case",":if(t.stdin=f(t.stdin,{type:"read",data:1}),h(t,t.stdin.readBuffer[0]),void 0===t.stdin.readBuffer[0])throw new Error("invalid write ".concat(t.stdin));break;case".":t.stdout=f(t.stdout,{type:"write",data:j(t)});break;case"[":0!==j(t)?t.jmpStack.push(t.programCounter):t.skipping=!0;break;case"]":0===j(t)?t.jmpStack.pop():(t.programCounter=t.jmpStack[t.jmpStack.length-1]+1,n=!0)}return n||t.programCounter++,t}(e);case"write":return function(e,t){var r=p(e);return r.stdin=f(r.stdin,{type:"write",data:t}),r}(e,t.data)}},y=r(3),k=r(14),x=function e(t,r,n){var a,i;if(r>n)throw new Error("Cannot parse an empty array");var o=r+Math.floor((n-r)/2),c=r<o?e(t,r,o-1):void 0,u=n>o?e(t,o+1,n):void 0;return{size:(null!==(a=null===c||void 0===c?void 0:c.size)&&void 0!==a?a:0)+(null!==(i=null===u||void 0===u?void 0:u.size)&&void 0!==i?i:0),key:o,value:t[o],left:c,right:u}},w=function e(t,r){if(!r)throw new Error("List index out of bounds");return r.key===t?r.value:r.key>t?e(t,r.left):e(t,r.right)},S=function e(t,r,n){if(!n)throw new Error("List index out of bounds");var a=Object.assign({},n);return a.key===t?(a.value=r,a):(a.key>t?a.left=e(t,r,a.left):a.right=e(t,r,a.right),a)},C=function e(t,r,n,a){if(!a)throw new Error("List index out of range");a.left&&e(t,r,n,a.left),a.key>=r&&a.key<n&&t.push(a.value),a.right&&e(t,r,n,a.right)},P=function(){function e(t){Object(y.a)(this,e),this.root=void 0,t.fromArray?this.root=x(t.array,0,t.array.length-1):this.root=t.root}return Object(k.a)(e,[{key:"query",value:function(e){return w(e,this.root)}},{key:"update",value:function(t,r){return new e({fromArray:!1,root:S(t,r,this.root)})}},{key:"slice",value:function(e,t){var r=[];return C(r,e,t,this.root),r}}]),e}(),N=function(e){return new P({fromArray:!0,array:e})},E=2<<16,A=function(e){for(var t=0;!m(e)&&++t<E;)e=O(e,{type:"next"});return t!==E||m(e)||console.error("The program runs exceeding the time limit"),{finalState:e,numCycles:t,ended:m(e)}},B=r(7),z=function(e){return String.fromCharCode.apply(String,Object(B.a)(e))},M=function(e){return Array.from(e).map((function(e){return e.charCodeAt(0)}))},q=function(e){return t=e,r=d(2048),n=d(2048),{programCounter:0,dataPointer:0,memory:N(Array(3e4).fill(0)),jmpStack:[],program:t,skipping:!1,stdin:r,stdout:n};var t,r,n},L=(r(73),r(74),r(0)),J=function(e){var t=e.programState,r=e.dispatch,a=Object(n.useState)(""),i=Object(c.a)(a,2),o=i[0],u=i[1],s=Object(n.useMemo)((function(){return{output:z(t.stdout.buffer),input:z(t.stdin.buffer)}}),[t]);return Object(L.jsxs)("div",{children:[Object(L.jsx)("div",{className:"console",children:Object(L.jsx)("div",{children:s.output})}),Object(L.jsxs)("div",{className:"console with-input",children:[Object(L.jsx)("div",{children:s.input}),Object(L.jsx)("div",{className:"console-input",children:Object(L.jsx)("input",{value:o,onKeyUp:function(e){"Enter"===e.key&&(r({type:"write",data:o}),u(""))},onChange:function(e){return u(e.target.value)}})})]})]})},R=(r(76),function(e){var t=e.programState,r=e.dispatch;return Object(L.jsxs)("ul",{className:"panel",children:[Object(L.jsx)("li",{children:Object(L.jsx)("button",{className:"btn",onClick:function(){return r({type:"run"})},children:"Run"})}),Object(L.jsx)("li",{children:Object(L.jsx)("button",{className:"btn",onClick:function(){return r({type:"next"})},disabled:m(t),children:v(t)?"Step":"Start"})}),Object(L.jsx)("li",{children:Object(L.jsx)("button",{className:"btn",onClick:function(){return r({type:"reset"})},children:"Reset"})})]})}),U=r(67),I=function(e){var t=e.code,r=e.setCode,n=e.enabled;return Object(L.jsx)(U.a,{value:t,language:"brainfuck",placeholder:"brainfuck program here",onChange:function(e){return r(e.target.value)},padding:10,style:{fontSize:"1.2rem"},disabled:!n})},K=(r(382),function(e){var t=e.programState;return Object(L.jsxs)("div",{children:[Object(L.jsxs)("p",{children:["program counter: ",t.programCounter]}),Object(L.jsxs)("p",{children:["data pointer: ",t.dataPointer]}),Object(L.jsxs)("p",{children:["current data: ",t.memory.query(t.dataPointer)]}),Object(L.jsx)("div",{className:"program-field",children:t.program.map((function(e,r){return Object(L.jsx)("span",{className:v(t)&&(n=r,n===t.programCounter-1||0===n&&0===t.programCounter)?"highlighted":"",children:e},r);var n}))})]})});var T=function(){var e=Object(n.useState)(""),t=Object(c.a)(e,2),r=t[0],a=t[1],i=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=Object(n.useState)(e),r=Object(c.a)(t,2),a=r[0],i=r[1],o=Object(n.useMemo)((function(){return g(a)}),[a]),u=Object(n.useState)(q(o)),s=Object(c.a)(u,2),d=s[0],f=s[1],l=Object(n.useCallback)((function(e){switch(e.type){case"load":i(e.data);break;case"next":f((function(e){return O(e,{type:"next"})}));break;case"run":f((function(e){return A(e).finalState}));break;case"reset":f(q(o));break;case"write":f((function(t){return O(t,{type:"write",data:M(e.data)})}))}}),[i,f,o]);return[d,l]}(r),o=Object(c.a)(i,2),u=o[0],s=o[1],d=Object(n.useState)(!0),f=Object(c.a)(d,1)[0];return Object(n.useEffect)((function(){s({type:"load",data:r}),s({type:"reset"})}),[r,s]),Object(L.jsx)("div",{className:"App",children:Object(L.jsxs)("main",{className:"App-main",children:[Object(L.jsx)("div",{children:Object(L.jsx)("h1",{id:"center",children:"react-brainfucked"})}),Object(L.jsxs)("div",{children:[Object(L.jsx)(I,{code:r,setCode:a,enabled:f}),Object(L.jsx)(K,{programState:u}),Object(L.jsx)(R,{programState:u,dispatch:s}),Object(L.jsx)(J,{programState:u,dispatch:s})]})]})})};r(383);o.a.render(Object(L.jsx)(a.a.StrictMode,{children:Object(L.jsx)(T,{})}),document.getElementById("root"))},73:function(e,t,r){},74:function(e,t,r){},76:function(e,t,r){}},[[384,1,2]]]);
//# sourceMappingURL=main.d75a6d36.chunk.js.map